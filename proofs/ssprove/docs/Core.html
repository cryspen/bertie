<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Core</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Core</h1>

<div class="code">
</div>
<details><summary>imports </summary><div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">all_ssreflect</span> <span class="id" title="var">fingroup.fingroup</span> <span class="id" title="var">ssreflect</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-ambiguous-paths".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Crypt</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">choice_type</span> <span class="id" title="var">Package</span> <span class="id" title="var">Prelude</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">PackageNotation</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">extructures</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ord</span> <span class="id" title="var">fset</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">word_ssrZ</span> <span class="id" title="var">word</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Strings.String</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">List.ListNotations</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">bool_scope</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hacspec</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ChoiceEquality</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hacspec</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">LocationUtility</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hacspec</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Hacspec_Lib_Comparable</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hacspec</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Hacspec_Lib_Pre</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Hacspec</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Hacspec_Lib</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">hacspec_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">choice.Choice.Exports</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Bullet</span> <span class="id" title="var">Behavior</span> "Strict Subproofs".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Goal</span> <span class="id" title="var">Selector</span> "!".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> <span class="id" title="keyword">Tactic</span> :=  <span class="id" title="var">solve_ssprove_obligations</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HB</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">structures</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Crypt</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">jasmin_word</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Crypt</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Schnorr</span> <span class="id" title="var">SigmaProtocol</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Relational</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">OrderEnrichedCategory</span> <span class="id" title="var">GenericRulesSimple</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-ambiguous-paths".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">mathcomp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">all_ssreflect</span> <span class="id" title="var">all_algebra</span> <span class="id" title="var">reals</span> <span class="id" title="var">distr</span> <span class="id" title="var">realsum</span><br/>
&nbsp;&nbsp;<span class="id" title="var">fingroup.fingroup</span> <span class="id" title="var">solvable.cyclic</span> <span class="id" title="var">prime</span> <span class="id" title="var">ssrnat</span> <span class="id" title="var">ssreflect</span> <span class="id" title="var">ssrfun</span> <span class="id" title="var">ssrbool</span> <span class="id" title="var">ssrnum</span><br/>
&nbsp;&nbsp;<span class="id" title="var">eqtype</span> <span class="id" title="var">choice</span> <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "notation-overridden,ambiguous-paths".<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Mon</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">SPropBase</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Crypt</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Axioms</span> <span class="id" title="var">ChoiceAsOrd</span> <span class="id" title="var">SubDistr</span> <span class="id" title="var">Couplings</span><br/>
&nbsp;&nbsp;<span class="id" title="var">UniformDistrLemmas</span> <span class="id" title="var">FreeProbProg</span> <span class="id" title="var">Theta_dens</span> <span class="id" title="var">RulesStateProb</span> <span class="id" title="var">UniformStateProb</span><br/>
&nbsp;&nbsp;<span class="id" title="var">pkg_core_definition</span> <span class="id" title="var">choice_type</span> <span class="id" title="var">pkg_composition</span> <span class="id" title="var">pkg_rhl</span> <span class="id" title="var">Package</span> <span class="id" title="var">Prelude</span><br/>
&nbsp;&nbsp;<span class="id" title="var">SigmaProtocol</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Utf8</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">extructures</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ord</span> <span class="id" title="var">fset</span> <span class="id" title="var">fmap</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Equations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">Equations.Prop.DepElim</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="var">With</span> <span class="id" title="var">UIP</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Bullet</span> <span class="id" title="var">Behavior</span> "Strict Subproofs".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Goal</span> <span class="id" title="var">Selector</span> "!".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">GroupScope</span> <span class="id" title="var">GRing.Theory</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">PackageNotation</span>.<br/>
</div>
</details><div class="code">

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h1 class="section">Core</h1>

 This file defines a cryptographic reduction framework based on the Gcore
 construction described in <span class="inlinecode"><span class="id" title="var">IACR</span></span> <span class="inlinecode">2021/467,</span> <span class="inlinecode"><span class="id" title="var">Figure</span></span> <span class="inlinecode">31</span>. It formalizes protocol
 components and their hybridization arguments for security analysis.

<div class="paragraph"> </div>

 Key definitions and properties:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">all_names</span></span> == list of all protocol-relevant names (<span class="inlinecode"><span class="id" title="var">PSK</span>;</span> <span class="inlinecode"><span class="id" title="var">DH</span></span> + N_star).

</li>
<li> <span class="inlinecode"><span class="id" title="var">N_star</span></span>    == predefined names excluding PSK/DH (<span class="inlinecode"><span class="id" title="var">ES</span>;</span> <span class="inlinecode"><span class="id" title="var">EEM</span>;</span> <span class="inlinecode">...;</span> <span class="inlinecode"><span class="id" title="var">ZERO_IKM</span></span>).

</li>
<li> <span class="inlinecode"><span class="id" title="var">N_star_correct</span></span> == lemma proving N_star correctly excludes PSK/DH.

</li>
</ul>

<div class="paragraph"> </div>

 Packages (via G_core_package_construction):
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">G_core_Hash</span></span> == null hash function (check: <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">false</span></span>, hash: <span class="inlinecode"><span class="id" title="var">Z</span></span>).

</li>
<li> <span class="inlinecode"><span class="id" title="var">G_core_D</span></span>    == deterministic behavior (D for all names).

</li>
<li> <span class="inlinecode"><span class="id" title="var">G_core_R_esalt</span></span> == random values for <span class="inlinecode"><span class="id" title="var">ESALT</span></span>, deterministic otherwise.

</li>
<li> <span class="inlinecode"><span class="id" title="var">G_core_SODH</span></span> == hybridization with <span class="inlinecode"><span class="id" title="var">HS</span></span> checks for idealization.

</li>
<li> <span class="inlinecode"><span class="id" title="var">G_core_hyb_ℓ</span></span> == parameterized hybrid packages (idealize names ≤ ℓ).

</li>
<li> <span class="inlinecode"><span class="id" title="var">G_core_ki</span></span>   == fully idealized package (all keys active).

</li>
</ul>

<div class="paragraph"> </div>

 Hybridization mechanics:
<ul class="doclist">
<li> Conditional behavior (e.g., <span class="inlinecode"><span class="id" title="var">i</span></span> <span class="inlinecode">&lt;=?</span> <span class="inlinecode"><span class="id" title="var">ℓ</span></span>) controls idealization thresholds.

</li>
<li> Modular design allows reuse of <span class="inlinecode"><span class="id" title="var">G_core_package_construction</span></span> for variants.

</li>
<li> Packages model real-world (e.g., <span class="inlinecode"><span class="id" title="var">G_core_Hash</span></span>) and idealized (e.g.,
   <span class="inlinecode"><span class="id" title="var">G_core_ki</span></span>) components for incremental security analysis.

</li>
</ul>

<div class="paragraph"> </div>

 Verification:
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">N_star_correct</span></span> ensures correctness of name exclusion logic.

</li>
<li> Assumes correctness of external definitions (e.g., <span class="inlinecode"><span class="id" title="var">G_check_XTR_XPD</span></span>).

</li>
<li> Hybrid packages depend on precise conditional logic for security proofs.

</li>
</ul>

<div class="paragraph"> </div>

 Applications:
 This module is part of a larger Coq development for verifying cryptographic
 protocols. It enables systematic simulation of protocol steps and their
 idealized counterparts, crucial for proving security reductions.
 See referenced paper for full context.                                      
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Types</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ExtraTypes</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Utility</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ssp_helper</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Dependencies</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">BasePackages</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">KeyPackages</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">KeyScheduleTheorem</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">XTR_XPD</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Core</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">DepInstance</span> : <span class="id" title="var">Dependencies</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Existing Instance</span> <span class="id" title="var">DepInstance</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h2 class="section">Definitions</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXTRinp' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span> × <span class="id" title="var">chHandle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXTRout' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">KS_interface</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;([<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> 0 <span class="id" title="var">k</span>] : <span class="id" title="var">chSETinp</span> → <span class="id" title="var">chSETout</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: (<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">reindex_interface_hierarchy_PSK2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">interface_hierarchy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>.+1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> 0 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_hierarchy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>, [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> (<span class="id" title="var">n</span>.+1) <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Hash</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bool</span> → <span class="id" title="var">package</span> <span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span> ] : <span class="id" title="var">chHASHinp</span> → <span class="id" title="var">chHASHout</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">trimmed_hash</span> (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">trimmed</span> ([<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">HASH</span>  <span class="id" title="var">f_hash</span> ] : <span class="id" title="var">chHASHinp</span> → <span class="id" title="var">chHASHout</span>]) (<span class="id" title="var">Hash</span> <span class="id" title="var">b</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Simulator</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([<span class="id" title="var">interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="var">val</span> #[ <span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> 0 <span class="id" title="var">k</span> ] : <span class="id" title="var">chSETinp</span> → <span class="id" title="var">chSETout</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">UNQ_O_star</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">xtr_dh</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) <span class="id" title="var">b</span> <span class="id" title="var">H_lt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">domm</span> (<span class="id" title="var">pack</span> (<span class="id" title="var">XTR_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">H_lt</span>)) :#: <span class="id" title="var">domm</span> (<span class="id" title="var">pack</span> (<span class="id" title="var">DH_package</span> <span class="id" title="var">k</span>)) = <span class="id" title="var">true</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">xpd_dh</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) <span class="id" title="var">H_lt</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">domm</span> (<span class="id" title="var">pack</span> (<span class="id" title="var">XPD_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span>)) :#: <span class="id" title="var">domm</span> (<span class="id" title="var">pack</span> (<span class="id" title="var">DH_package</span> <span class="id" title="var">k</span>)) = <span class="id" title="var">true</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Obligation</span> <span class="id" title="keyword">Tactic</span> :=  <span class="id" title="tactic">idtac</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_XPD_</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">key_b</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>) (<span class="id" title="var">fset</span> [::]) (<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XPR</span> ++ <span class="id" title="var">XPR_parents</span>)) <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XPR</span> ++ <span class="id" title="var">XPR_parents</span>)) (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">F</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">b</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">XPD_</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>) [<span class="id" title="var">interface</span>] (<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XPD_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> ∘<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">k</span> (<span class="id" title="var">H_lt</span>) (<span class="id" title="var">undup</span> (<span class="id" title="var">XPR</span> ++ <span class="id" title="var">XPR_parents</span>)) <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XPR</span> ++ <span class="id" title="var">XPR_parents</span>)) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">F</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_XPD_</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_XTR_</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">key_b</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> ≤ <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>) (<span class="id" title="var">fset</span> [::]) (<span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XTR_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_parent_names</span> ++ <span class="id" title="var">XTR_names</span>)) <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_parent_names</span> ++ <span class="id" title="var">XTR_names</span>)) (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">XTR_</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">key_b</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> ≤ <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>) (<span class="id" title="var">fset</span> [::]) (<span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span> <span class="id" title="var">XTR_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">H_lt</span> ∘<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_parent_names</span> ++ <span class="id" title="var">XTR_names</span>)) <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> (<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_parent_names</span> ++ <span class="id" title="var">XTR_names</span>)) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_XTR_</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">idents_disjoint_foreach_in</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>: <span class="id" title="var">eqType</span>} <span class="id" title="var">f</span> <span class="id" title="var">g</span> (<span class="id" title="var">L</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">m</span>, (<span class="id" title="var">m</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">L</span>) → <span class="id" title="var">idents</span> <span class="id" title="var">f</span> :#: <span class="id" title="var">idents</span> (<span class="id" title="var">g</span> <span class="id" title="var">m</span>)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idents</span> <span class="id" title="var">f</span> :#: <span class="id" title="var">idents</span> (<span class="id" title="var">interface_foreach</span> <span class="id" title="var">g</span> <span class="id" title="var">L</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_XPD_DH_XTR</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b_hash</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">key_b</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: (<span class="id" title="var">DH_interface</span> :|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b_hash</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">DH_package</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>) [:: <span class="id" title="var">DH</span>] <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> [:: <span class="id" title="var">DH</span>] (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">F</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XTR_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_names</span> ++ <span class="id" title="var">XTR_parent_names</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_names</span> ++ <span class="id" title="var">XTR_parent_names</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>) <span class="id" title="var">O_star</span> <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> <span class="id" title="var">O_star</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">XPD_DH_XTR</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b_hash</span> <span class="id" title="var">b</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: (<span class="id" title="var">DH_interface</span> :|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b_hash</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">DH_package</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>) [<span class="id" title="var">DH</span>] <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> [<span class="id" title="var">DH</span>] (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">F</span>) <span class="id" title="var">erefl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XTR_packages</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_names</span> ++ <span class="id" title="var">XTR_parent_names</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">undup</span> (<span class="id" title="var">XTR_names</span> ++ <span class="id" title="var">XTR_parent_names</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>) <span class="id" title="var">O_star</span> <span class="id" title="var">key_b</span> <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> <span class="id" title="var">O_star</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Z</span>) (<span class="id" title="var">erefl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_XPD_DH_XTR</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b_hash</span> <span class="id" title="var">b</span> <span class="id" title="var">key_b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab9"></a><h1 class="section">Actual core</h1>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXPDinp' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span> × '<span class="id" title="var">bool</span> × <span class="id" title="var">bitvec</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXPDout' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>

<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">∀</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">∈</span> <span class="inlinecode"><span class="id" title="var">O</span></span>: the path from psk to n contains an <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode">∈</span> <span class="inlinecode"><span class="id" title="var">S</span>.</span>
      If there exists a path from <span class="inlinecode"><span class="id" title="var">dh</span></span> to an <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">∈</span> <span class="inlinecode"><span class="id" title="var">O</span></span>, then it contains an <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode">∈</span> <span class="inlinecode"><span class="id" title="var">S</span></span>.
   
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">seperation_points</span> := [<span class="id" title="var">BIND</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">early</span> := [<span class="id" title="var">BIND</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">BinderArgs</span> : <span class="id" title="var">bitvec</span> → <span class="id" title="var">code</span> <span class="id" title="var">fset0</span> <span class="id" title="var">fset0</span> <span class="id" title="var">chKey</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">BinderHand</span> : <span class="id" title="var">chHandle</span> → <span class="id" title="var">bitvec</span> → <span class="id" title="var">code</span> <span class="id" title="var">fset0</span> <span class="id" title="var">fset0</span> <span class="id" title="var">chHandle</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">DhArgs</span> : <span class="id" title="var">bitvec</span> → <span class="id" title="var">code</span> <span class="id" title="var">fset0</span> <span class="id" title="var">fset0</span> (<span class="id" title="var">chProd</span> <span class="id" title="var">chGroup</span> <span class="id" title="var">chGroup</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">DhHand</span> : <span class="id" title="var">chHandle</span> → <span class="id" title="var">code</span> <span class="id" title="var">fset0</span> <span class="id" title="var">fset0</span> <span class="id" title="var">chHandle</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">sort</span> : (<span class="id" title="var">chProd</span> <span class="id" title="var">chGroup</span> <span class="id" title="var">chGroup</span>) → (<span class="id" title="var">chProd</span> <span class="id" title="var">chGroup</span> <span class="id" title="var">chGroup</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">dh_angle</span> : (<span class="id" title="var">chProd</span> <span class="id" title="var">chGroup</span> <span class="id" title="var">chGroup</span>) → <span class="id" title="var">chHandle</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">check_raw</span> (<span class="id" title="var">d</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">raw_package</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">mkfmap</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span> (<span class="id" title="var">XPD</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">mkdef</span> (<span class="id" title="var">chProd</span> (<span class="id" title="var">chProd</span> <span class="id" title="var">chHandle</span> <span class="id" title="var">chBool</span>) <span class="id" title="var">bitvec</span>) <span class="id" title="var">chHandle</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> '(<span class="id" title="var">pair</span> (<span class="id" title="var">pair</span> <span class="id" title="var">h1</span> <span class="id" title="var">r</span>) <span class="id" title="var">args</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="var">import</span> {<span class="id" title="var">sig</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">BINDER</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">d</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span> }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">get_fn</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="var">import</span> {<span class="id" title="var">sig</span> #[ <span class="id" title="var">XPD</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">d</span> ] : <span class="id" title="var">chXPDinp</span> → <span class="id" title="var">chXPDout</span> }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">xpd_fn</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <span class="id" title="var">name_eq</span> <span class="id" title="var">n</span> <span class="id" title="var">BIND</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">r</span> == <span class="id" title="var">false</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">assert</span> (<span class="id" title="keyword">level</span> <span class="id" title="var">h1</span> == 0) <span class="id" title="keyword">else</span> <span class="id" title="var">ret</span> <span class="id" title="var">Datatypes.tt</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">r</span> == <span class="id" title="var">true</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">assert</span> (<span class="id" title="keyword">level</span> <span class="id" title="var">h1</span> &gt;? 0) <span class="id" title="keyword">else</span> <span class="id" title="var">ret</span> <span class="id" title="var">Datatypes.tt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">name_to_chName</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span> (<span class="id" title="var">List.map</span> <span class="id" title="var">name_to_chName</span> <span class="id" title="var">seperation_points</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&amp;: <span class="id" title="var">fset</span> (<span class="id" title="var">List.map</span> <span class="id" title="var">name_to_chName</span> <span class="id" title="var">early</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binder</span> ← <span class="id" title="var">BinderArgs</span> <span class="id" title="var">args</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h_bndr</span> ← <span class="id" title="var">BinderHand</span> <span class="id" title="var">h1</span> <span class="id" title="var">args</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'(<span class="id" title="var">k</span>, <span class="id" title="var">_</span>) ← <span class="id" title="var">get_fn</span> <span class="id" title="var">h_bndr</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">binder</span> == <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">seperation_points</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'(<span class="id" title="var">X</span>,<span class="id" title="var">Y</span>) ← <span class="id" title="var">DhArgs</span>(<span class="id" title="var">args</span>) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">X</span> : <span class="id" title="var">chGroup</span> := <span class="id" title="var">X</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h_dh</span> ← <span class="id" title="var">DhHand</span>(<span class="id" title="var">h1</span>) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">h_dh</span> == <span class="id" title="var">dh_angle</span> (<span class="id" title="var">sort</span> (<span class="id" title="var">X</span>, <span class="id" title="var">Y</span>))) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binder</span> ← <span class="id" title="var">BinderArgs</span>(<span class="id" title="var">args</span>) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h_bndr</span> ← <span class="id" title="var">BinderHand</span> <span class="id" title="var">h1</span> <span class="id" title="var">args</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'(<span class="id" title="var">k</span>, <span class="id" title="var">_</span>) ← <span class="id" title="var">get_fn</span> <span class="id" title="var">h_bndr</span> ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">binder</span> == <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">ret</span> <span class="id" title="var">Datatypes.tt</span>) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h</span> ← <span class="id" title="var">xpd_fn</span> (<span class="id" title="var">h1</span>, <span class="id" title="var">r</span>, <span class="id" title="var">args</span>) ;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ret</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))) <span class="id" title="var">nil</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">check_valid</span> <span class="id" title="var">d</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span> <span class="id" title="var">f_parameter_cursor_loc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n_ℓ_f</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">BINDER</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">d</span>] : <span class="id" title="var">chXPDout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n_ℓ_f</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span>) (<span class="id" title="var">check_raw</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">check</span> <span class="id" title="var">d</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> <span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n_ℓ_f</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">BINDER</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">d</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n_ℓ_f</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span> <span class="id" title="var">check_raw</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> #<span class="id" title="keyword">with</span> <span class="id" title="var">check_valid</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_check</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> ≤ <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> <span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: <span class="id" title="var">GET_n</span> [<span class="id" title="var">BINDER</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_dh</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> ≤ <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> <span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">DH</span>] <span class="id" title="var">k</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DH_interface</span> := <span class="id" title="var">DH_package</span> <span class="id" title="var">k</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">I_star</span> : <span class="id" title="var">seq</span> <span class="id" title="var">name</span> := [:: <span class="id" title="var">RM</span>; <span class="id" title="var">ES</span>; <span class="id" title="var">BIND</span>; <span class="id" title="var">HS</span>; <span class="id" title="var">AS</span>; <span class="id" title="var">ESALT</span>; <span class="id" title="var">HSALT</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_direct_in</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">fsubUset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">apply</span> /<span class="id" title="var">andP</span> ; <span class="id" title="tactic">split</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">fsubsetxx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" title="tactic">apply</span> <span class="id" title="var">fsubsetU</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">apply</span> /<span class="id" title="var">orP</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; ((<span class="id" title="tactic">right</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">fsubsetxx</span>) || <span class="id" title="tactic">left</span>))).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_XTR_XPD</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> <span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">GET_n</span> [<span class="id" title="var">DH</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [<span class="id" title="var">ZERO_SALT</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [<span class="id" title="var">ZERO_IKM</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_hierarchy</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> <span class="id" title="var">ℓ</span>.+1 <span class="id" title="var">k</span> ] : <span class="id" title="var">chSETinp</span> → <span class="id" title="var">chSETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span> ] : <span class="id" title="var">chHASHinp</span> → <span class="id" title="var">chHASHout</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_idents</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> ?<span class="id" title="var">a</span> :#: <span class="id" title="var">idents</span> (?<span class="id" title="var">b</span> :|: ?<span class="id" title="var">c</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">idents</span> <span class="id" title="tactic">at</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">imfsetU</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">fold</span> (<span class="id" title="var">idents</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">fold</span> (<span class="id" title="var">idents</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fdisjointUr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">apply</span> /<span class="id" title="var">andP</span> ; <span class="id" title="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> (?<span class="id" title="var">a</span> :|: ?<span class="id" title="var">b</span>) :#: <span class="id" title="var">idents</span> ?<span class="id" title="var">c</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">idents</span> <span class="id" title="tactic">at</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">imfsetU</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">fold</span> (<span class="id" title="var">idents</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">fold</span> (<span class="id" title="var">idents</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fdisjointUl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">apply</span> /<span class="id" title="var">andP</span> ; <span class="id" title="tactic">split</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> (<span class="id" title="var">fset</span> (?<span class="id" title="var">a</span> :: ?<span class="id" title="var">b</span> :: <span class="id" title="var">_</span>)) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">fset_cons</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ ?<span class="id" title="var">K</span> :#: <span class="id" title="var">idents</span> (<span class="id" title="var">interface_hierarchy</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">d</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idents_interface_hierachy3</span> ; <span class="id" title="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> (<span class="id" title="var">interface_hierarchy</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">d</span>) :#: ?<span class="id" title="var">K</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">fdisjointC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">apply</span> <span class="id" title="var">idents_interface_hierachy3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> (<span class="id" title="var">interface_foreach</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:#:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idents</span> (<span class="id" title="var">interface_foreach</span> ?<span class="id" title="var">g</span> ?<span class="id" title="var">K</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idents_foreach_disjoint_foreach_in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">now</span> <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">move</span>: <span class="id" title="var">H</span> ⇒ /<span class="id" title="var">orP</span> [ /<span class="id" title="var">eqP</span> ? | <span class="id" title="var">H</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> ?<span class="id" title="var">K</span> :#: <span class="id" title="var">idents</span> (<span class="id" title="var">interface_foreach</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">L</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">idents_disjoint_foreach_in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">intros</span> ? <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">idents</span> (<span class="id" title="var">interface_foreach</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">L</span>) :#: ?<span class="id" title="var">K</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">fdisjointC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">unfold</span> <span class="id" title="var">idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">solve_imfset_disjoint</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_trimmed2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> <span class="id" title="var">_</span> (<span class="id" title="var">trim</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_trim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">parallel_raw</span> <span class="id" title="var">_</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">trimmed_parallel_raw</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | | <span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_pairs_map</span> ; <span class="id" title="tactic">intros</span>  ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="id" title="tactic">reflexivity</span> | ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ | <span class="id" title="var">solve_trimmed2</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">idents</span> ; <span class="id" title="var">solve_imfset_disjoint</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> <span class="id" title="var">_</span> (<span class="id" title="var">pack</span> (<span class="id" title="var">ℓ_packages</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_ℓ_packages</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">par</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">trimmed_par</span> ; [ | <span class="id" title="var">solve_trimmed2</span>..] ; <span class="id" title="var">solve_idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">pack</span> {| <span class="id" title="var">pack</span> := <span class="id" title="var">_</span>; |}) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">pack</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">mkfmap</span> (<span class="id" title="var">cons</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>)) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_package_cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">mkfmap</span> <span class="id" title="var">nil</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_empty_package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">trimmed</span> ?<span class="id" title="var">E</span> (<span class="id" title="var">ID</span> <span class="id" title="var">_</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trimmed_ID</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">parable_link_l</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <span class="id" title="var">Parable</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> → <span class="id" title="var">Parable</span> (<span class="id" title="var">a</span> ∘ <span class="id" title="var">c</span>) <span class="id" title="var">b</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">parable_link_r</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <span class="id" title="var">Parable</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> → <span class="id" title="var">Parable</span> <span class="id" title="var">a</span> (<span class="id" title="var">b</span> ∘ <span class="id" title="var">c</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">split_Parable</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">Parable</span> ?<span class="id" title="var">a</span> (<span class="id" title="var">par</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">c</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssp_helper.parable_par_r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">Parable</span> (<span class="id" title="var">par</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span>) ?<span class="id" title="var">c</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssp_helper.parable_par_l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">Parable</span> ?<span class="id" title="var">a</span> (?<span class="id" title="var">b</span> ∘ ?<span class="id" title="var">c</span>) ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">parable_link_r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">Parable</span> (?<span class="id" title="var">a</span> ∘ ?<span class="id" title="var">b</span>) ?<span class="id" title="var">c</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">parable_link_l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_Parable2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">split_Parable</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">Parable</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ] ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H0</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eassert</span> (<span class="id" title="var">H</span> : <span class="id" title="var">trimmed</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">solve_trimmed2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">eassert</span> (<span class="id" title="var">H0</span> : <span class="id" title="var">trimmed</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>) <span class="id" title="tactic">by</span> <span class="id" title="var">solve_trimmed2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span> ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">solve_Parable</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">solve_idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">serialize_name_disjoint_idents1</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span> {<span class="id" title="var">t</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">name</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> ≠ <span class="id" title="var">y</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:#: <span class="id" title="var">idents</span> (<span class="id" title="var">fset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name</span> <span class="id" title="var">y</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span>)).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">serialize_name_disjoint_idents2</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> <span class="id" title="var">index</span> {<span class="id" title="var">t</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ℓ</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;→ (<span class="id" title="var">n</span> ≤ <span class="id" title="var">d</span>)%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;→ ∀ <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">name</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name</span> <span class="id" title="var">x</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:#: <span class="id" title="var">idents</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name</span> <span class="id" title="var">y</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span>)).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">serialize_name_flat</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span> {<span class="id" title="var">t</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">name</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">flat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cons</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pair</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span>)).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_G_core</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span> (<span class="id" title="var">G_check</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">XTR_names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">XTR</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRinp</span> → <span class="id" title="var">chXPDout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXPDout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXPDout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">b</span>) <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_dh</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">parallel_ID</span> <span class="id" title="var">d</span> [:: <span class="id" title="var">PSK</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">name</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXPDout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 0 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 0 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>) <span class="id" title="var">all_names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">_</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">_</span> : <span class="id" title="var">name</span>), <span class="id" title="var">b</span>) <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> <span class="id" title="var">all_names</span> (<span class="id" title="var">λ</span> <span class="id" title="var">_</span> : <span class="id" title="var">name</span>, <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">K_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">H_lt</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">L_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">b</span>)).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">XTR_names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">XTR</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chXTRinp</span> → <span class="id" title="var">chXTRout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">b</span>) <span class="id" title="var">H_lt</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_dh</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">parallel_ID</span> <span class="id" title="var">d</span> [:: <span class="id" title="var">PSK</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">SET</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">k</span> ] : <span class="id" title="var">chSETinp</span> → <span class="id" title="var">chSETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 0 <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 0 <span class="id" title="var">_</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> (<span class="id" title="var">DepInstance</span> := <span class="id" title="var">DepInstance</span>) <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>) <span class="id" title="var">all_names</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">b</span>) <span class="id" title="var">erefl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> (<span class="id" title="var">DepInstance</span> := <span class="id" title="var">DepInstance</span>) <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all_names</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Z</span>) <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">K_package</span> (<span class="id" title="var">DepInstance</span> := <span class="id" title="var">DepInstance</span>) <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PSK</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">H_lt</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">L_package</span> (<span class="id" title="var">DepInstance</span> := <span class="id" title="var">DepInstance</span>) <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_G_core</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">b</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXTRinp' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span> × <span class="id" title="var">chHandle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; 'chXTRout' " :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">chHandle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">in</span> <span class="id" title="var">custom</span> <span class="id" title="var">pack_type</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 2).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_KeysAndHash</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f_ks</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">f_ls</span> : <span class="id" title="var">name</span> → <span class="id" title="var">ZAF</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Names</span> (<span class="id" title="var">Names_uniq</span> : <span class="id" title="var">uniq</span> <span class="id" title="var">Names</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span> [::])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_n</span> <span class="id" title="var">Names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> <span class="id" title="var">d</span>.+1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">Names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>) <span class="id" title="var">Names</span> <span class="id" title="var">f_ks</span> <span class="id" title="var">Names_uniq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> <span class="id" title="var">Names</span> <span class="id" title="var">f_ls</span> <span class="id" title="var">Names_uniq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">K_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">H_lt</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">L_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">true</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">KeysAndHash</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) <span class="id" title="var">f_ks</span> <span class="id" title="var">f_ls</span> <span class="id" title="var">Names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Names_uniq</span> : <span class="id" title="var">uniq</span> <span class="id" title="var">Names</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">SET_n</span> <span class="id" title="var">Names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> <span class="id" title="var">d</span>.+1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">Names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ]) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ks</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>) <span class="id" title="var">Names</span> <span class="id" title="var">f_ks</span> <span class="id" title="var">Names_uniq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">Ls</span> <span class="id" title="var">k</span> <span class="id" title="var">Names</span> <span class="id" title="var">f_ls</span> <span class="id" title="var">Names_uniq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">K_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">d</span>.+1 <span class="id" title="var">H_lt</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">L_package</span> <span class="id" title="var">k</span> <span class="id" title="var">PSK</span> <span class="id" title="var">Z</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Hash</span> <span class="id" title="var">true</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_KeysAndHash</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> <span class="id" title="var">f_ks</span> <span class="id" title="var">f_ls</span> <span class="id" title="var">Names</span> <span class="id" title="var">Names_uniq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">subset_all</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">interface_hierarchy_foreach</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O_star</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: (<span class="id" title="var">GET_n</span> [:: <span class="id" title="var">DH</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_SALT</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_IKM</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_hierarchy</span> (<span class="id" title="var">λ</span> <span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> <span class="id" title="var">ℓ</span>.+1 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: (<span class="id" title="var">SET_ℓ</span> [:: <span class="id" title="var">DH</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_foreach</span> (<span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">name</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[:: <span class="id" title="var">PSK</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&lt;=: <span class="id" title="var">SET_n</span> <span class="id" title="var">all_names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> <span class="id" title="var">d</span>.+1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">all_names</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_G_check_XTR_XPD</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>) (<span class="id" title="var">f_XTR_XPD</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span> <span class="id" title="var">f_parameter_cursor_loc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">interface_hierarchy_foreach</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O_star</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">GET_n</span> [:: <span class="id" title="var">DH</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_SALT</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_IKM</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_hierarchy</span> (<span class="id" title="var">λ</span> <span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> <span class="id" title="var">ℓ</span>.+1 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">XTR_names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">XTR</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">f_XTR_XPD</span> <span class="id" title="var">H_lt</span>))).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_check_XTR_XPD</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) <span class="id" title="var">f_XTR_XPD</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fset0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">interface_hierarchy_foreach</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> (<span class="id" title="var">n</span> : <span class="id" title="var">name</span>) (<span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span>] : <span class="id" title="var">chXTRout</span> → <span class="id" title="var">chGETout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O_star</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: (<span class="id" title="var">GET_n</span> [:: <span class="id" title="var">DH</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_SALT</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> [:: <span class="id" title="var">ZERO_IKM</span>] <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">SET_n</span> <span class="id" title="var">I_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">interface_hierarchy</span> (<span class="id" title="var">λ</span> <span class="id" title="var">ℓ</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">PSK</span> <span class="id" title="var">ℓ</span>.+1 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: [<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">HASH</span> <span class="id" title="var">f_hash</span>] : <span class="id" title="var">chHASHout</span> → <span class="id" title="var">chHASHout</span> ]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> :|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">XTR_names</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">XTR</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chXTRinp</span> → <span class="id" title="var">chXTRout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ (<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">combined_ID</span> <span class="id" title="var">d</span> <span class="id" title="var">O_star</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">GET</span> <span class="id" title="var">n</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">k</span> ] : <span class="id" title="var">chGETinp</span> → <span class="id" title="var">chGETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents2</span> <span class="id" title="var">k</span> <span class="id" title="var">d</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">f_XTR_XPD</span> <span class="id" title="var">H_lt</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_G_check_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> <span class="id" title="var">f_XTR_XPD</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">valid_G_core_package_construction</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check_XTR_XPD_f</span> : <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">KeysAndHash_Kf</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">name</span> → <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">KeysAndHash_Lf</span> : <span class="id" title="var">name</span> → <span class="id" title="var">ZAF</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ValidPackage</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fset</span> [::])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [:: <span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> <span class="id" title="var">G_check_XTR_XPD_f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_dh</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">d</span>) (<span class="id" title="var">n</span>:=<span class="id" title="var">k</span>) <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">parallel_ID</span> <span class="id" title="var">k</span> [:: <span class="id" title="var">PSK</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">λ</span> <span class="id" title="var">n</span> : <span class="id" title="var">name</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[<span class="id" title="var">SET</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">k</span>] : <span class="id" title="var">chUNQinp</span> → <span class="id" title="var">chXTRout</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 0 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 0 0)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∘ <span class="id" title="var">KeysAndHash</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Kf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Lf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all_names</span> <span class="id" title="var">erefl</span>).<br/>
 
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_package_construction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_check_XTR_XPD_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Kf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Lf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_check_XTR_XPD</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> <span class="id" title="var">G_check_XTR_XPD_f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">par</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G_dh</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> (<span class="id" title="var">ltnW</span> <span class="id" title="var">H_lt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">parallel_ID</span> <span class="id" title="var">k</span> [:: <span class="id" title="var">PSK</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span> #<span class="id" title="var">val</span> #[ <span class="id" title="var">SET</span> <span class="id" title="var">n</span> 0 <span class="id" title="var">k</span> ] : <span class="id" title="var">chSETinp</span> → <span class="id" title="var">chSETout</span>])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">serialize_name_disjoint_idents1</span> <span class="id" title="var">k</span> 0 <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erefl</span> (<span class="id" title="var">serialize_name_flat</span> <span class="id" title="var">k</span> 0 <span class="id" title="var">_</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) ∘ (<span class="id" title="var">KeysAndHash</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span> <span class="id" title="var">KeysAndHash_Kf</span> <span class="id" title="var">KeysAndHash_Lf</span> <span class="id" title="var">all_names</span> <span class="id" title="var">erefl</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">valid_G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_check_XTR_XPD_f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Kf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">KeysAndHash_Lf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
</div>

<div class="doc">
<a id="lab10"></a><h2 class="section">Packages of intermediate steps in G-core reduction</h2>
 <a href=https://eprint.iacr.org/2021/467.pdf#figure.caption.1681>Page 70 : Fig 31.</a> Proof overview 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_Hash</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">Z</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_D</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">D</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_R_esalt</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">ESALT</span> ⇒ <span class="id" title="var">R</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">D</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_SODH</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> <span class="id" title="var">HS</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">ESALT</span> ⇒ <span class="id" title="var">R</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">D</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">N_star</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">ES</span>; <span class="id" title="var">EEM</span>; <span class="id" title="var">CET</span>; <span class="id" title="var">BIND</span>; <span class="id" title="var">BINDER</span>; <span class="id" title="var">HS</span>; <span class="id" title="var">SHT</span>; <span class="id" title="var">CHT</span>; <span class="id" title="var">HSALT</span>; <span class="id" title="var">AS</span>; <span class="id" title="var">RM</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">CAT</span>; <span class="id" title="var">SAT</span>; <span class="id" title="var">EAM</span>; <span class="id" title="var">ZERO_SALT</span>; <span class="id" title="var">ESALT</span>; <span class="id" title="var">ZERO_IKM</span>].<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N_star_correct</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, (<span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">all_names</span> ∧ <span class="id" title="var">x</span> \<span class="id" title="var">notin</span> [<span class="id" title="var">PSK</span>; <span class="id" title="var">DH</span>]) ↔ <span class="id" title="var">x</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">N_star</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_hyb_ℓ</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> <span class="id" title="var">HS</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">name</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">name</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">N_star</span>) || (<span class="id" title="var">name</span> == <span class="id" title="var">PSK</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">i</span> &lt;=? <span class="id" title="var">ℓ</span>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">false</span> <span class="id" title="keyword">else</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">ESALT</span> ⇒ <span class="id" title="var">R</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">D</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
</div>

<div class="doc">
Idealization order (hybridazation argument for a given level) 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_hyb_pred_ℓ_c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">C</span> : <span class="id" title="var">list</span> <span class="id" title="var">name</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> <span class="id" title="var">HS</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ℓ</span> <span class="id" title="var">name</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">name</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">N_star</span>) || (<span class="id" title="var">name</span> == <span class="id" title="var">PSK</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">i</span> + (<span class="id" title="var">name</span> \<span class="id" title="tactic">in</span> <span class="id" title="var">C</span>) &lt;=? <span class="id" title="var">ℓ</span>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">false</span> <span class="id" title="keyword">else</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">false</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">ESALT</span> ⇒ <span class="id" title="var">R</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">D</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">G_core_ki</span> (<span class="id" title="var">d</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H_lt</span> : (<span class="id" title="var">d</span> &lt; <span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">package</span> (<span class="id" title="var">L_K</span> :|: <span class="id" title="var">L_L</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">interface</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XPD_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">DH_interface</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">SET_ℓ</span> [<span class="id" title="var">PSK</span>] <span class="id" title="var">k</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">XTR_n</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:|: <span class="id" title="var">GET_n</span> <span class="id" title="var">O_star</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G_core_package_construction</span> <span class="id" title="var">d</span> <span class="id" title="var">k</span> <span class="id" title="var">H_lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">name</span> <span class="id" title="keyword">with</span> <span class="id" title="var">HS</span> ⇒ <span class="id" title="var">true</span> | <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">name</span> ⇒ <span class="id" title="var">D</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Core</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>